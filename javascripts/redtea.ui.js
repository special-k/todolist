/*
This is RedTea v0.3 - js library

TERMS OF USE RedTea

RedTea is licensed under a commercial and CC BY-SA-NC licenses.

I want to make sure that you are fully aware of
the license types of RedTea and which is the correct one to
use based on your development project. 
It is important that you are in the know of the requirements of developing under CC BY-SA-NC.
Learn about the CC BY-SA-NC requirements here http://creativecommons.org/licenses/by-nc-sa/3.0/deed.ru

Questions about the RedTea commercial license?
I recommend contact with me special-k@li.com for more information on the RedTea commercial license, 
what it enables and how you can start developing with it.

Copyright Â© 2012-2015 Kirill Jakovlev
 */
(function(){var t=function(t,i){function s(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return s.prototype=i.prototype,t.prototype=new s,t.__super__=i.prototype,t},e={}.hasOwnProperty;glob.RedTeaUI||(glob.RedTeaUI={}),RedTeaUI.BaseWidget=function(e){function i(t){var e,i;if(null!=t)for(e in t)i=t[e],this[e]=i}return t(i,e),i.prototype.destroy=function(){return this.removeSelf(),delete this.dom},i}(RedTeaWidget),RedTeaUI.VeriField=function(e){function i(){i.__super__.constructor.apply(this,arguments),this.classes||(this.classes=[]),this.classes.push(r),this.classes.push(l),this.classes.push(s),this.field=this.input({"class":this.classes.join(n)}).bi(RTC.KEYUP,this.onKeyUp,{context:this}).bi(RTC.FOCUS,this.onFocus,{context:this}),this.loadedResults={}}var s,o,n,r,l;return t(i,e),o="onResult",i.prototype.dir="/field/verification",i.prototype.timeout=1e3,i.prototype.isSaving=!1,i.prototype.reqSending=!1,i.prototype.isChecking=!1,i.prototype.lastValue="",i.prototype.alreadyFocused=!1,r="ui",l="veriField",s="notFocused",n=" ",i.register(l),i.prototype.onKeyUp=function(t,e){return this.lastValue!==this.field.value&&this.checksThroughDelay(),this.lastValue=this.field.value},i.prototype.onFocus=function(t,e){return this.alreadyFocused?void 0:(this.alreadyFocused=!0,this.field.remCls(s))},i.prototype.checksThroughDelay=function(){return this.reqSending||this.isChecking?void 0:(this.isChecking=!0,setTimeout(function(t){return function(){return t.isChecking=!1,t.sendedValue!==t.field.value?t.startChecks():void 0}}(this),this.timeout))},i.prototype.onComlete=function(t,e){var i;return 4===e.target.readyState&&200===e.target.status&&(this.reqSending=!1,i=JSON.parse(e.target.responseText),this.loadedResults[this.sendedValue]=i,this.action(i,this.sendedValue)),4===e.target.readyState&&200!==e.target.status&&(this.reqSending=!1,this.field.value!==this.sendedValue)?this.startChecks():void 0},i.prototype.action=function(t,e){return this.fire(o,t,e)},i.prototype.startChecks=function(){var t,e;return t=this.field.value,this.sendedValue=t,null!=this.loadedResults[t]?this.action(this.loadedResults[t],t):this.parse(t)?(this.reqSending=!0,e=new XMLHttpRequest,e.bi(RTC.READYSTATECHANGE,this.onComlete,{context:this}),e.open(RTC.GET,this.dir+"/"+t),e.send()):void 0},i.prototype.parse=function(){return!0},i}(RedTeaUI.BaseWidget),RedTeaUI.Mask=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}var s,o;return t(i,e),o="ui",s="mask",i.register(s),i.prototype.timeInterval=100,i.prototype.moveX=!0,i.prototype.moveY=!0,i.prototype.createDom=function(t){return this.div({"class":this.withParamsClasses(o+" "+s)})},i.prototype.init=function(){return glob.isTouchDevice?(this.dom.bi(RTC.TOUCHSTART,this.onmousedown,{context:this}),glob.bi(RTC.TOUCHEND,this.onmouseup,{context:this})):(this.dom.bi(RTC.MOUSEDOWN,this.onmousedown,{context:this}),glob.bi(RTC.MOUSEUP,this.onmouseup,{context:this}))},i.prototype.onmousedown=function(t,e){var i;return null==this.movablePanel&&this.setMovablePanel(),null!=this.intervalId&&clearInterval(this.intervalId),null!=e.touches&&(e=e.touches[0]),glob.isTouchDevice?glob.bi(RTC.TOUCHMOVE,this.onmousemove,{context:this}):glob.bi(RTC.MOUSEMOVE,this.onmousemove,{context:this}),i=this.movablePanel.getBoundingClientRect(),this.movablePanelWidth=i.width,this.movablePanelHeight=i.height,i=this.dom.getBoundingClientRect(),this.maskWidth=i.width,this.maskHeight=i.height,this.x=e.clientX,this.y=e.clientY,this.clientX=this.x,this.clientY=this.y,this.elX=parseFloat(this.movablePanel.style.marginLeft)||0,this.elY=parseFloat(this.movablePanel.style.marginTop)||0,this.intervalId=setInterval(function(t){return function(){return t.setPosition()}}(this),this.timeInterval)},i.prototype.onmouseup=function(t,e){return clearInterval(this.intervalId),delete this.intervalId,glob.isTouchDevice?glob.unbi(RTC.TOUCHMOVE,this.onmousemove,{context:this}):glob.unbi(RTC.MOUSEMOVE,this.onmousemove,{context:this})},i.prototype.onmousemove=function(t,e){return e.preventDefault(),null!=e.touches&&(e=e.touches[0]),this.newClientX=e.clientX,this.newClientY=e.clientY},i.prototype.coordCorrect=function(t,e,i,s,o,n){var r;return r=t+s-e,0>r&&n>r+o?o>n?e+s-i:e:r>0&&r+o>n&&o>n?e+s-i:e},i.prototype.clientCorrect=function(t,e,i,s,o,n){var r;return r=t+s-e,0>r&&r+o>n?s:0>r&&n>r+o?o>n?e-t-o+n:e-t:r>0&&n>r+o?s:r>0&&r+o>n?o>n?e-t:e-t+n-o:o===n?e-t:s},i.prototype.setMovablePanel=function(){return this.movablePanel=this.dom.firstChild,this.movablePanelStyle=this.movablePanel.style},i.prototype.unsetMovablePanel=function(){return delete this.movablePanel,delete this.movablePanelStyle},i.prototype.setPosition=function(){var t;return t=!1,this.moveX?this.newClientX!==this.oldClientX&&(t=!0,this.oldClientX=this.newClientX,this.clientX=this.clientCorrect(this.elX,this.x,this.clientX,this.newClientX,this.movablePanelWidth,this.maskWidth)):this.clientX=this.x,this.moveY?this.newClientY!==this.oldClientY&&(t=!0,this.oldClientY=this.newClientY,this.clientY=this.clientCorrect(this.elY,this.y,this.clientY,this.newClientY,this.movablePanelHeight,this.maskHeight)):this.clientY=this.y,t?this.movablePanelStyle.margin=this.elY+this.clientY-this.y+"px 0 0 "+(this.elX+this.clientX-this.x)+"px":void 0},i}(RedTeaWidget),RedTeaUI.DelayButton=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}var s,o,n,r,l;return t(i,e),l="ui",s="delayButton",n="onClick",o="disabled",r="pressed",i.register(s),i.prototype.isPressed=!1,i.prototype.isDisabled=!1,i.prototype.isStateful=!1,i.prototype.timeout=200,i.prototype.createDom=function(){return this.a({href:RTC.EMPTY_HREF,"class":this.withParamsClasses(l+" "+s)}).bi(RTC.CLICK,this.onClick,{context:this}).notClickTimout(this.timeout)},i.prototype.onClick=function(t,e){return e.preventDefault(),t.notClick||this.isDisabled?void 0:(this.isStateful&&(this.isPressed?this.unpress():this.press()),this.fire(n))},i.prototype.enable=function(){return this.dom.remCls(o),this.isDisabled=!1},i.prototype.disable=function(){return this.dom.addCls(o),this.isDisabled=!0},i.prototype.press=function(){return this.dom.addCls(r),this.isPressed=!0},i.prototype.unpress=function(){return this.dom.remCls(r),this.isPressed=!1},i}(RedTeaWidget),RedTeaUI.DelayDivButton=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}var s,o;return t(i,e),o="ui",s="delayDivButton",i.register(s),i.prototype.createDom=function(){return this.div({"class":this.withParamsClasses(o+" "+s)}).bi(RTC.CLICK,this.onClick,{context:this}).notClickTimout(this.timeout)},i}(RedTeaUI.DelayButton),RedTeaUI.LinkButton=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}var s,o,n;return t(i,e),n="ui",s="linkButton",o="onClick",i.register(s),i.prototype.createDom=function(){return this.a({href:RTC.EMPTY_HREF,"class":this.withParamsClasses(n+" "+s)}).bi(RTC.CLICK,this.onClick,{context:this})},i.prototype.onClick=function(t,e){return e.preventDefault(),this.isDisabled?void 0:(this.isStateful&&(this.isPressed?this.unpress():this.press()),this.fire(o))},i}(RedTeaUI.DelayButton),RedTeaUI.SlideCounter=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}var s,o,n,r;return t(i,e),n="ui",o="slideCounter",s="onValue",r="valueEl",i.register(o),i.prototype.value=0,i.prototype.preciseValue=0,i.prototype.interval=100,i.prototype.oldValue=0,i.prototype.lock=!1,i.prototype.wait=!1,i.prototype.waitTimeout=3e3,i.prototype.speedKoef=1,i.prototype.step=1,i.prototype.createDom=function(t){return this.div({"class":this.withParamsClasses(n+" "+o)},function(){return this.span(function(){return this.tn(t.value).setta(r,t)})})},i.prototype.init=function(){return this.preciseValue=this.value,glob.isTouchDevice?(this.dom.bi(RTC.TOUCHSTART,"start",{context:this}),glob.bi(RTC.TOUCHEND,"stop",{context:this})):(this.dom.bi(RTC.MOUSEDOWN,"start",{context:this}),glob.bi(RTC.MOUSEUP,"stop",{context:this}))},i.prototype.start=function(t,e){return e.stopPropagation(),e.preventDefault(),this.lock=!0,this.wait=!1,null!=e.touches&&(e=e.touches[0]),glob.isTouchDevice?glob.bi(RTC.TOUCHMOVE,"move",{context:this}):glob.bi(RTC.MOUSEMOVE,"move",{context:this}),this.y=e.clientY,this.newY=e.clientY,this.intervalId=setInterval(function(t){return function(){return t.calculate()}}(this),this.interval)},i.prototype.stop=function(){return this.lock?(this.lock=!1,clearInterval(this.intervalId),delete this.intervalId,glob.isTouchDevice?glob.unbi(RTC.TOUCHMOVE,"move",{context:this}):glob.unbi(RTC.MOUSEMOVE,"move",{context:this}),this.wait=!0,setTimeout(function(t){return function(){return t.wait&&t.oldValue!==t.value&&(t.oldValue=t.value,t.fire(s,t.value)),t.wait=!1}}(this),this.waitTimeout)):void 0},i.prototype.move=function(t,e){return null!=e.touches&&(e=e.touches[0]),this.newY=e.clientY},i.prototype.calculate=function(){var t,e;return t=this.newY-this.y,this.y=this.newY,e=0!==t?t/Math.abs(t):1,this.speed=e*t*t/50*this.speedKoef,this.preciseValue-=this.speed,null!=this.minValue&&this.preciseValue<this.minValue&&(this.preciseValue=this.minValue),null!=this.maxValue&&this.preciseValue>this.maxValue&&(this.preciseValue=this.maxValue),this.value=Math.round(this.preciseValue/this.step)*this.step,this.valueEl.nodeValue=this.value},i.prototype.update=function(t){return this.lock||this.wait?void 0:(this.preciseValue=t,this.value=t,this.oldValue=t,this.valueEl.nodeValue=this.value)},i.prototype.setValue=function(t){return this.value=t,this.preciseValue=this.value,this.valueEl.nodeValue=this.value,this.fire(s,this.value)},i}(RedTeaWidget),RedTeaUI.RadioGroup=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}var s,o,n,r,l;return t(i,e),l="ui",r="radioGroup",n="radio",o="onClick",s="onCheck",i.register(r),i.prototype.createDom=function(t){return this.div({"class":this.withParamsClasses(l+" "+r)})},i.prototype.isFirstChildUpdate=!0,i.prototype.init=function(){return this.buttons=[],this.value=this.defaultValue},i.prototype.add=function(t){return this.addHelper(this.dom,t),this.updateChildren()},i.prototype.updateChildren=function(){var t,e,i,r,l;for(r=this.dom.childNodes,e=0,i=r.length;i>e;e++)t=r[e],l=t.widget,null!=t.hasCls&&t.hasCls(n)&&(this.isFirstChildUpdate||-1===this.buttons.indexOf(l))&&(t.widget.bi(o,s,{context:this}),this.buttons.push(l),this.value===l.value&&this.onCheck(l));return this.isFirstChildUpdate=!1},i.prototype.onCheck=function(t){return null!=this.selectedButton&&this.selectedButton.unpress(),this.selectedButton=t,this.value=t.value,t.press(),this.fire(s,this.value)},i.prototype.getValue=function(){return this.value},i.prototype.drop=function(){var t,e,i,s,o;for(this.value=this.defaultValue,s=this.buttons,o=[],e=0,i=s.length;i>e;e++){if(t=s[e],t.value===this.value){this.onCheck(t);break}o.push(void 0)}return o},i}(RedTeaWidget),RedTeaUI.Dropdown=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}var s,o,n,r,l,h,u,a,c,p,d,v,f;return t(i,e),o="dropdown",f="ui",h="onClick",u="onToggleShowPanel",a="onGlobalHidePanel",n="hidePanel",r="itemName",s="arrow",d="panel",v="showPanel",l="nameEl",c="onHidePanel",p="onShowPanel",i.register("dropdown"),i.prototype.withArrow=!0,i.prototype.name="",i.prototype.init=function(){return window.bi(a,n,{context:this}),window.bi(RTC.CLICK,a,{context:this}),window.bi(RTC.BEFOREUNLOAD,n,{context:this})},i.prototype.createDom=function(t){return this.div({"class":this.withParamsClasses(o)},function(){return this.delayButton({classes:r}).bi(h,u,{context:t}).add(function(){return this.tn(t.name).setas(l,t),t.withArrow?this.div({"class":s}):void 0}),this.div({"class":d}).setas(d,t)})},i.prototype.add=function(t){return this.addHelper(this.panel,t)},i.prototype.onToggleShowPanel=function(){return this.hasCls(v)?this.hidePanel():this.showPanel()},i.prototype.hidePanel=function(){return this.hasCls(v)?(this.dom.remCls(v),this.fire(c)):void 0},i.prototype.showPanel=function(){return this.hasCls(v)?void 0:(this.dom.addCls(v),this.fire(p))},i.prototype.onGlobalHidePanel=function(t,e){return this.dom.contains(e.target)?void 0:this.hidePanel()},i.prototype.setName=function(t){return this.name=t,this.nameEl.nodeValue=t},i}(RedTeaWidget)}).call(this);
